(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1343],{3038:(e,t,r)=>{Promise.resolve().then(r.bind(r,7368))},4990:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(5155);r(2115);let s=e=>{let{variant:t="light",color:r="primary",size:s="md",startIcon:d,endIcon:l,children:n}=e,i={light:{primary:"bg-brand-50 text-brand-500 dark:bg-brand-500/15 dark:text-brand-400",success:"bg-success-50 text-success-600 dark:bg-success-500/15 dark:text-success-500",error:"bg-error-50 text-error-600 dark:bg-error-500/15 dark:text-error-500",warning:"bg-warning-50 text-warning-600 dark:bg-warning-500/15 dark:text-orange-400",info:"bg-blue-light-50 text-blue-light-500 dark:bg-blue-light-500/15 dark:text-blue-light-500",light:"bg-gray-100 text-gray-700 dark:bg-white/5 dark:text-white/80",dark:"bg-gray-500 text-white dark:bg-white/5 dark:text-white"},solid:{primary:"bg-brand-500 text-white dark:text-white",success:"bg-success-500 text-white dark:text-white",error:"bg-error-500 text-white dark:text-white",warning:"bg-warning-500 text-white dark:text-white",info:"bg-blue-light-500 text-white dark:text-white",light:"bg-gray-400 dark:bg-white/5 text-white dark:text-white/80",dark:"bg-gray-700 text-white dark:text-white"}}[t][r];return(0,a.jsxs)("span",{className:"".concat("inline-flex items-center px-2.5 py-0.5 justify-center gap-1 rounded-full font-medium"," ").concat({sm:"text-theme-xs",md:"text-sm"}[s]," ").concat(i),children:[d&&(0,a.jsx)("span",{className:"mr-1",children:d}),n,l&&(0,a.jsx)("span",{className:"ml-1",children:l})]})}},7354:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(5155);r(2115);let s=e=>{let{type:t="text",id:r,name:s,placeholder:d,value:l,defaultValue:n,onChange:i,className:o="",min:c,max:x,step:g,disabled:h=!1,success:u=!1,error:m=!1,hint:b,autoComplete:y,required:p=!1}=e,f="h-11 w-full rounded-lg border appearance-none px-4 py-2.5 text-sm shadow-theme-xs placeholder:text-gray-400 focus:outline-hidden focus:ring-3 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800 ".concat(o);return h?f+=" text-gray-500 border-gray-300 cursor-not-allowed dark:bg-gray-800 dark:text-gray-400 dark:border-gray-700":m?f+=" text-error-800 border-error-500 focus:ring-3 focus:ring-error-500/10  dark:text-error-400 dark:border-error-500":u?f+=" text-success-500 border-success-400 focus:ring-success-500/10 focus:border-success-300  dark:text-success-400 dark:border-success-500":f+=" bg-transparent text-gray-800 border-gray-300 focus:border-brand-300 focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:focus:border-brand-800",(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:t,id:r,name:s,placeholder:d,value:l,defaultValue:n,onChange:i,min:c,max:x,step:g,disabled:h,autoComplete:y,required:p,className:f}),b&&(0,a.jsx)("p",{className:"mt-1.5 text-xs ".concat(m?"text-error-500":u?"text-success-500":"text-gray-500"),children:b})]})}},7368:(e,t,r)=>{"use strict";r.d(t,{default:()=>h});var a=r(5155),s=r(2115),d=r(6874),l=r.n(d),n=r(4990);function i(e){let{currentPage:t,totalPages:r,onPageChange:d}=e,l=(0,s.useMemo)(()=>{let e=Math.max(1,t-1);return Array.from({length:Math.min(3,r)},(t,a)=>Math.min(e+a,r))},[t,r]);return(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("button",{onClick:()=>d(Math.max(1,t-1)),disabled:1===t,className:"mr-2.5 flex h-10 items-center justify-center rounded-lg border border-gray-300 bg-white px-3.5 py-2.5 text-sm text-gray-700 shadow-theme-xs hover:bg-gray-50 disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]",children:"Previous"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[t>3&&(0,a.jsx)("span",{className:"px-2 text-gray-400",children:"..."}),l.map(e=>(0,a.jsx)("button",{onClick:()=>d(e),className:"flex h-10 w-10 items-center justify-center rounded-lg text-sm font-medium ".concat(t===e?"bg-brand-500 text-white":"text-gray-700 hover:bg-blue-500/[0.08] hover:text-brand-500 dark:text-gray-400 dark:hover:text-brand-500"),children:e},e)),t<r-2&&(0,a.jsx)("span",{className:"px-2 text-gray-400",children:"..."})]}),(0,a.jsx)("button",{onClick:()=>d(Math.min(r,t+1)),disabled:t===r,className:"ml-2.5 flex h-10 items-center justify-center rounded-lg border border-gray-300 bg-white px-3.5 py-2.5 text-sm text-gray-700 shadow-theme-xs hover:bg-gray-50 disabled:opacity-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:hover:bg-white/[0.03]",children:"Next"})]})}var o=r(7354);let c={open:"success",pending:"warning",resolved:"success",closed:"error"},x=e=>e&&c[e.toLowerCase()]||"info",g=e=>new Intl.DateTimeFormat("en",{dateStyle:"medium",timeStyle:"short"}).format(new Date(e));function h(e){let{tickets:t,initialPageSize:r=8}=e,[d,c]=(0,s.useState)(1),[h,u]=(0,s.useState)(r),[m,b]=(0,s.useState)(t),[y,p]=(0,s.useState)(""),[f,k]=(0,s.useState)("all"),[w,j]=(0,s.useState)("30"),[v,N]=(0,s.useState)(""),[D,C]=(0,s.useState)(!1),[M,S]=(0,s.useState)(()=>new Date),L=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!D)return;let e=e=>{L.current&&!L.current.contains(e.target)&&C(!1)};return window.addEventListener("mousedown",e),()=>window.removeEventListener("mousedown",e)},[D]),(0,s.useEffect)(()=>{if(v){let e=new Date(v);Number.isNaN(e.getTime())||S(e)}},[v]);let F=(0,s.useMemo)(()=>{let e=y.trim().toLowerCase(),t=Date.now();return m.filter(r=>{var a,s,d,l;let n=[r.id,null!==(s=r.subject)&&void 0!==s?s:"",null!==(d=r.brand)&&void 0!==d?d:"",null!==(l=r.product)&&void 0!==l?l:""].join(" ").toLowerCase(),i=!e||n.includes(e),o=null===(a=r.status)||void 0===a?void 0:a.toLowerCase(),c="all"===f||o===f.toLowerCase(),x=new Date(r.updatedAt).getTime(),g=!0;if("today"===w)g=x>=new Date().setHours(0,0,0,0);else if("7"===w)g=t-x<=6048e5;else if("30"===w)g=t-x<=2592e6;else if("older"===w)g=t-x>2592e6;else if("custom"===w&&v){let e=new Date(v).setHours(0,0,0,0);g=x>=e&&x<e+864e5}return i&&c&&g})},[m,y,f,w,v]),T=(0,s.useMemo)(()=>Math.max(1,Math.ceil(F.length/h)),[F.length,h]),E=(0,s.useMemo)(()=>F.slice((d-1)*h,d*h),[F,d,h]);(0,s.useEffect)(()=>{b(t)},[t]);let _=!!y.trim()||"all"!==f||"30"!==w||!!v,A=(0,s.useMemo)(()=>{let e=new Date(M.getFullYear(),M.getMonth(),1),t=new Date(M.getFullYear(),M.getMonth()+1,0),r=[],a=e.getDay();for(let t=0;t<a;t++){let s=new Date(e);s.setDate(s.getDate()-(a-t)),r.push({date:s,label:s.getDate()})}for(let e=1;e<=t.getDate();e++)r.push({date:new Date(M.getFullYear(),M.getMonth(),e),label:e});let s=42-r.length;for(let e=1;e<=s;e++){let a=new Date(t);a.setDate(t.getDate()+e),r.push({date:a,label:a.getDate()})}return r},[M]),P=v?new Intl.DateTimeFormat("en",{month:"short",day:"numeric",year:"numeric"}).format(new Date(v)):null;function O(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function Y(e){S(t=>new Date(t.getFullYear(),t.getMonth()+e,1))}async function I(e){if(confirm("Delete this ticket? This action cannot be undone."))try{let t=await fetch("/api/tickets/".concat(e),{method:"DELETE"});if(!t.ok){let e=await t.json().catch(()=>({}));alert((null==e?void 0:e.error)||"Failed to delete ticket");return}let r=F.some(t=>t.id===e),a=m.filter(t=>t.id!==e);if(b(a),r){let e=F.length-1,t=Math.max(1,Math.ceil(e/h));d>t&&c(t)}}catch(e){console.error("Failed to delete ticket",e),alert("Failed to delete ticket")}}return(0,a.jsx)("div",{className:"space-y-5",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4 rounded-3xl border border-gray-200 bg-white p-4 shadow-lg shadow-gray-200/40 dark:border-white/5 dark:bg-white/[0.02] dark:shadow-none sm:p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Tickets"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage and track conversations from any shift or day."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("label",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Per page"}),(0,a.jsx)("select",{value:h,onChange:e=>{u(Number(e.target.value)),c(1)},className:"rounded-lg border border-gray-200 bg-white px-2 py-1 text-sm text-gray-800 dark:border-gray-700 dark:bg-gray-800 dark:text-white",children:[4,8,12,20].map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(o.A,{placeholder:"Search by ticket id, subject, brand, or product",value:y,onChange:e=>{p(e.target.value),c(1)}})}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row",children:[(0,a.jsxs)("select",{value:f,onChange:e=>{k(e.target.value),c(1)},className:"rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200",children:[(0,a.jsx)("option",{value:"all",children:"All statuses"}),(0,a.jsx)("option",{value:"open",children:"Open"}),(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"resolved",children:"Resolved"}),(0,a.jsx)("option",{value:"closed",children:"Closed"})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("select",{value:w,onChange:e=>{let t=e.target.value;j(t),"custom"!==t&&N(""),C("custom"===t),c(1)},className:"rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200",children:[(0,a.jsx)("option",{value:"today",children:"Today"}),(0,a.jsx)("option",{value:"7",children:"Last 7 days"}),(0,a.jsx)("option",{value:"30",children:"Last 30 days"}),(0,a.jsx)("option",{value:"older",children:"Older than 30 days"}),(0,a.jsx)("option",{value:"all",children:"All time"}),(0,a.jsx)("option",{value:"custom",children:"Specific day"})]}),"custom"===w&&(0,a.jsxs)("div",{className:"relative",ref:L,children:[(0,a.jsxs)("button",{type:"button",onClick:()=>C(e=>!e),className:"flex w-full items-center justify-between rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm text-gray-700 transition hover:border-brand-300 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200",children:[(0,a.jsx)("span",{children:P||"Choose a date"}),(0,a.jsx)("svg",{className:"size-4 transition ".concat(D?"rotate-180":""),viewBox:"0 0 17 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M1.5 1.5L8.5 8.5L15.5 1.5",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round"})})]}),D&&(0,a.jsxs)("div",{className:"absolute right-0 z-50 mt-2 w-64 rounded-2xl border border-gray-200 bg-white p-4 shadow-xl dark:border-white/10 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"mb-3 flex items-center justify-between text-sm font-medium text-gray-700 dark:text-white",children:[(0,a.jsx)("button",{type:"button",onClick:()=>Y(-1),className:"rounded-full px-2 py-1 text-gray-500 transition hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-white/10",children:"‹"}),(0,a.jsx)("span",{children:M.toLocaleString("en",{month:"long",year:"numeric"})}),(0,a.jsx)("button",{type:"button",onClick:()=>Y(1),className:"rounded-full px-2 py-1 text-gray-500 transition hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-white/10",children:"›"})]}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-1 text-center text-xs font-medium text-gray-400 dark:text-gray-500",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(e=>(0,a.jsx)("span",{children:e},e))}),(0,a.jsx)("div",{className:"mt-2 grid grid-cols-7 gap-1 text-center",children:A.map((e,t)=>{let{date:r,label:s}=e,d=r.getMonth()===M.getMonth(),l=v&&O(r,new Date(v)),n=O(r,new Date);return(0,a.jsx)("button",{type:"button",onClick:()=>{N(r.toISOString().slice(0,10)),j("custom"),C(!1),c(1)},className:"h-9 rounded-full text-sm transition ".concat(l?"bg-brand-500 text-white":n?"border border-brand-400 text-brand-500":"text-gray-700 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-white/10"," ").concat(d?"":"text-gray-400 dark:text-gray-500"),children:s},"".concat(r.toISOString(),"-").concat(t))})})]})]})]}),_&&(0,a.jsx)("button",{onClick:function(){p(""),k("all"),j("30"),N(""),C(!1),c(1)},className:"rounded-lg border border-gray-200 px-3 py-2 text-xs font-medium text-gray-600 transition hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300",children:"Clear filters"})]})]})]}),0===E.length?(0,a.jsx)("div",{className:"rounded-2xl border border-dashed border-gray-200 p-10 text-center text-sm text-gray-500 dark:border-white/10 dark:text-gray-400",children:"No tickets found for this filter set. Try adjusting your filters to view older shifts."}):(0,a.jsx)("div",{className:"space-y-4",children:E.map(e=>(0,a.jsxs)("article",{className:"group flex flex-col gap-4 rounded-2xl border border-gray-200 bg-white p-4 transition hover:border-brand-200 hover:shadow-xl dark:border-white/[0.08] dark:bg-white/[0.02] lg:flex-row lg:items-center lg:justify-between",children:[(0,a.jsxs)("div",{className:"grid gap-4 lg:flex-1 lg:grid-cols-[150px_150px_180px_minmax(220px,_1fr)]",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("p",{className:"text-xs font-medium uppercase tracking-wide text-gray-400 dark:text-gray-500",children:"Ticket"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["#",e.id]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-gray-400 dark:text-gray-500",children:"Brand"}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-800 dark:text-gray-100",children:e.brand||"—"})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-gray-400 dark:text-gray-500",children:"Product"}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-800 dark:text-gray-100",children:e.product||"—"})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-1 lg:col-auto",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-wide text-gray-400 dark:text-gray-500",children:"Subject"}),(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white line-clamp-2",children:e.subject||"No subject"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-start gap-3 text-xs text-gray-500 dark:text-gray-400 sm:items-end sm:text-right",children:[(0,a.jsx)(n.A,{color:x(e.status),size:"sm",children:e.status||"Unknown"}),(0,a.jsxs)("span",{children:["Updated ",g(e.updatedAt)]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l(),{href:"/dashboard/tickets/".concat(e.id),className:"rounded-full border border-gray-200 px-3 py-1 text-xs font-medium text-gray-700 transition hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-200",children:"View"}),(0,a.jsx)("button",{onClick:()=>I(e.id),className:"rounded-full border border-red-200 px-3 py-1 text-xs font-medium text-red-600 transition hover:bg-red-50 dark:border-red-900 dark:bg-red-950/40 dark:text-red-300",children:"Delete"})]})]})]},e.id))}),(0,a.jsxs)("div",{className:"flex flex-col gap-3 pt-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Showing ",(d-1)*h+1," -"," ",Math.min(d*h,F.length)," of ",F.length]}),(0,a.jsx)(i,{currentPage:d,totalPages:T,onPageChange:c})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[6874,8441,1684,7358],()=>t(3038)),_N_E=e.O()}]);